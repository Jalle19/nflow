<div>
  <tabset>
    <tab heading="Active instances" >
      <div ng-hide="ctrl.hasStatistics" class="alert alert-info">
        No workflow instances in non-final states.
      </div>
      <div ng-show="ctrl.hasStatistics">
        <div>
          <h3>Number of workflow instances in execution phases</h3>
          <p>Includes only non-final states.</p>
          <svg id="statisticsGraph"></svg>
        </div>
      </div>
    </tab>
    <tab heading="All instances">
      <table id="state-list" class="table table-striped table-hover">
        <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th class="numeric">Executing</th>
          <th class="numeric">Queued</th>
          <th class="numeric">Sleeping</th>
          <th class="numeric">Total&nbsp;active</th>
          <th class="numeric">Passive</th>
          <th></th>
        </tr>
        <tr>
          <th colspan="2">Total</th>
          <th class="numeric" title="Workflow instances currently executing">{{ctrl.definition.stateStatisticsTotal.executing}}</th>
          <th class="numeric" title="Workflow instances ready for execution (next activation in the past)">{{ctrl.definition.stateStatisticsTotal.queued}}</th>
          <th class="numeric" title="Workflow instances scheduled into the future (next activation in the future)">{{ctrl.definition.stateStatisticsTotal.sleeping}}</th>
          <th class="numeric" title="Sum of executing, queued and sleeping workflow instances">{{ctrl.definition.stateStatisticsTotal.totalActive}}</th>
          <th class="numeric" title="Unscheduled workflow instances (next activation: never)">{{ctrl.definition.stateStatisticsTotal.nonScheduled}}</th>
          <th></th>
        </tr>
        </thead>
        <tbody>
        <tr class="{{state.selected}}" ng-repeat="state in ctrl.definition.states" ng-click="ctrl.selectNode(state.id)">
          <td>{{state.name}}</td>
          <td>{{state.description}}</td>
          <td class="numeric" title="Workflow instances currently executing">{{state.stateStatistics.executing | nullToZero}}</td>
          <td class="numeric" title="Workflow instances ready for execution (next activation in the past)">{{state.stateStatistics.queued | nullToZero}}</td>
          <td class="numeric" title="Workflow instances scheduled into the future (next activation in the future)">{{state.stateStatistics.sleeping | nullToZero}}</td>
          <th class="numeric" title="Sum of executing, queued and sleeping workflow instances">{{state.stateStatistics.totalActive | nullToZero}}</th>
          <td class="numeric" title="Unscheduled workflow instances (next activation: never)">{{state.stateStatistics.nonScheduled | nullToZero}}</td>
          <td><a href="#/search?type={{ctrl.definition.type}}&state={{state.name}}"><span class="glyphicon glyphicon-search"></span></a></td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
          <th colspan="2">Total</th>
          <th class="numeric" title="Workflow instances currently executing">{{ctrl.definition.stateStatisticsTotal.executing}}</th>
          <th class="numeric" title="Workflow instances ready for execution (next activation in the past)">{{ctrl.definition.stateStatisticsTotal.queued}}</th>
          <th class="numeric" title="Workflow instances scheduled into the future (next activation in the future)">{{ctrl.definition.stateStatisticsTotal.sleeping}}</th>
          <th class="numeric" title="Sum of executing, queued and sleeping workflow instances">{{ctrl.definition.stateStatisticsTotal.totalActive}}</th>
          <th class="numeric" title="Unscheduled workflow instances (next activation: never)">{{ctrl.definition.stateStatisticsTotal.nonScheduled}}</th>
          <th></th>
        </tr>
        </tfoot>
      </table>
    </tab>
    <tab heading="Workflow settings">
      <table class="table table-striped table-hover">
        <thead>
        <tr><th>Setting</th><th>Value</th></tr>
        </thead>
        <tbody>
        <tr ng-repeat="(key, value) in ctrl.definition.settings">
          <td>{{key}}</td>
          <td><pre>{{value | prettyPrintJson}}</pre></td>
        </tr>
        </tbody>
      </table>
    </tab>
    <tab heading="Radiator" select="ctrl.startRadiator()">
      <div data-ng-include data-src="'app/workflow-stats/workflowStats.html'"></div>
    </tab>
  </tabset>
</div>
